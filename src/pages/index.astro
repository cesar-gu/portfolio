---
import Navigation from '../components/Navigation.vue';
import HeroSection from '../components/HeroSection.vue';
import SkillsShowcase from '../components/SkillsShowcase.vue';
import ExperienceSection from '../components/ExperienceSection.vue';
import EducationSection from '../components/EducationSection.vue';
import ProjectsSection from '../components/ProjectsSection.vue';
import Footer from '../components/Footer.vue';
import portfolio from '../data/portfolio.json';

// SEO Meta Tags
const seoTitle = 'César Gutiérrez | Desarrollador Frontend especializado en Angular y Vue';
const seoDescription =
  'Ingeniero informático con 10+ años de experiencia en desarrollo Frontend. Especializado en Angular y Vue. Ubicado en León, España.';
const seoKeywords = [
  'Frontend Developer',
  'Angular',
  'Vue.js',
  'TypeScript',
  'Web Development',
  'César Gutiérrez',
  'León',
].join(', ');

// Sort experiences by date (most recent first)
const sortedExperiences = [...portfolio.work].sort(
  (a, b) => new Date(b.startDate).getTime() - new Date(a.startDate).getTime()
);

// Sort education by date (most recent first)
const sortedEducation = [...portfolio.education].sort(
  (a, b) => parseInt(b.startDate) - parseInt(a.startDate)
);
---

<!doctype html>
<html lang="es">
  <head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-J99F1BCJ8H"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag('js', new Date());

      gtag('config', 'G-J99F1BCJ8H');
    </script>

    <!-- Meta Tags -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
    <meta name="generator" content={Astro.generator} />

    <!-- SEO -->
    <title>{seoTitle}</title>
    <meta name="description" content={seoDescription} />
    <meta name="keywords" content={seoKeywords} />
    <meta name="author" content="César Gutiérrez" />
    <meta name="robots" content="index, follow" />
    <meta name="theme-color" content="#0066cc" />

    <!-- Preload LCP image (hero) -->
    <link rel="preload" as="image" href={portfolio.basics.image} />

    <!-- Canonical -->
    <link rel="canonical" href="https://cesar-gu.github.io/portfolio" />

    <!-- Open Graph -->
    <meta property="og:type" content="website" />
    <meta property="og:locale" content="es_ES" />
    <meta property="og:title" content={seoTitle} />
    <meta property="og:description" content={seoDescription} />
    <meta
      property="og:image"
      content="https://cesar-gu.github.io/portfolio/images/social-card.svg"
    />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />
    <meta property="og:url" content="https://cesar-gu.github.io/portfolio" />
    <meta property="og:site_name" content="César Gutiérrez Portfolio" />

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content={seoTitle} />
    <meta name="twitter:description" content={seoDescription} />
    <meta
      name="twitter:image"
      content="https://cesar-gu.github.io/portfolio/images/social-card.svg"
    />

    <!-- Google Site Verification -->
    <meta name="google-site-verification" content="XnaifBXWdkpbhO3Q4HGK0R6nkIV5nM4-Yxdln5NWb9Q" />

    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="/portfolio/favicon.svg" />

    <!-- Styles -->
    <style is:global>
      @import 'tailwindcss/base';
      @import 'tailwindcss/components';
      @import 'tailwindcss/utilities';

      /* Importar fuentes locales */
      @import '../styles/fonts.css';

      * {
        font-family: 'Inter', system-ui, sans-serif;
      }

      h1,
      h2,
      h3,
      h4,
      h5,
      h6 {
        font-family: 'Space Grotesk', sans-serif;
      }

      h1 *,
      h2 *,
      h3 *,
      h4 *,
      h5 *,
      h6 * {
        font-family: inherit;
      }

      html {
        scroll-behavior: smooth;
      }

      body {
        background-color: #ffffff;
        color: #1f2937;
      }

      ::selection {
        background-color: #0066cc;
        color: white;
      }

      /* Accessibility: Reduce motion for users who prefer it */
      @media (prefers-reduced-motion: reduce) {
        *,
        *::before,
        *::after {
          animation-duration: 0.01ms !important;
          animation-iteration-count: 1 !important;
          transition-duration: 0.01ms !important;
          scroll-behavior: auto !important;
        }
      }
    </style>
  </head>

  <body class="antialiased bg-gray-900">
    <!-- Navigation -->
    <Navigation client:load basics={portfolio.basics} />

    <!-- Main Content -->
    <main id="main-content">
      <!-- Hero Section -->
      <HeroSection client:load basics={portfolio.basics} expertise={portfolio.expertise} />

      <!-- Projects Section -->
      <ProjectsSection client:load projects={portfolio.projects || []} basics={portfolio.basics} />

      <!-- Skills Section -->
      <SkillsShowcase client:load skills={portfolio.skills} expertise={portfolio.expertise} />

      <!-- Experience Section -->
      <ExperienceSection
        client:load
        experiences={sortedExperiences}
        knownTechs={portfolio.knownTechs}
      />

      <!-- Education Section -->
      <EducationSection client:load education={sortedEducation} trainings={portfolio.trainings} />
    </main>

    <!-- Footer -->
    <Footer client:load basics={portfolio.basics} expertise={portfolio.expertise} />

    <!-- Initialize AOS (locally imported) -->
    <script>
      import 'aos/dist/aos.css';
      import AOS from 'aos';

      AOS.init({
        duration: 600,
        easing: 'ease-in-out-cubic',
        once: true,
        mirror: false,
        offset: 80,
      });
    </script>

    <!-- Schema.org Structured Data -->
    <script
      type="application/ld+json"
      is:inline
      set:html={JSON.stringify({
        '@context': 'https://schema.org',
        '@type': 'Person',
        name: 'César Gutiérrez',
        jobTitle: 'Desarrollador Frontend',
        image: 'https://cesar-gu.github.io/portfolio/images/profile.webp',
        email: 'cesargupe95@gmail.com',
        url: 'https://cesar-gu.github.io/portfolio',
        sameAs: [
          'https://www.linkedin.com/in/cesargupe/',
          'https://github.com/cesar-gu',
          'https://gitlab.com/cesargupe',
        ],
        location: {
          '@type': 'Place',
          name: 'León, Spain',
        },
        description:
          'Ingeniero informático con 10+ años de experiencia en desarrollo Frontend. Especializado en Angular y Vue.',
      })}
    />

    <!-- Additional structured data: WebSite + ContactPage -->
    <script
      type="application/ld+json"
      is:inline
      set:html={JSON.stringify({
        '@context': 'https://schema.org',
        '@type': 'WebSite',
        url: 'https://cesar-gu.github.io/portfolio',
        name: 'César Gutiérrez Portfolio',
        author: { '@type': 'Person', name: 'César Gutiérrez' },
        publisher: { '@type': 'Organization', name: 'cesargú' },
      })}
    />

    <script
      type="application/ld+json"
      is:inline
      set:html={JSON.stringify({
        '@context': 'https://schema.org',
        '@type': 'ContactPage',
        url: 'https://cesar-gu.github.io/portfolio',
        name: 'Contacto - César Gutiérrez',
        description: 'Página de contacto y enlaces a perfiles profesionales.',
      })}
    />
  </body>
</html>
